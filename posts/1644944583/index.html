<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"momaoto.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":"auto","version":"8.20.0","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12,"profile":{"enable":true,"tagline":"XJTU -> THU"}},"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="mujoco学习笔记与问题记录。官方jupyter入门教程：https:&#x2F;&#x2F;github.com&#x2F;google-deepmind&#x2F;mujoco&#x2F;blob&#x2F;main&#x2F;python&#x2F;tutorial.ipynb   仿真器 123456# 安装mujocopip install mujocopip install mujoco-python-viewer# 启动可视化界面，可以直接把模型拖进去预览p">
<meta property="og:type" content="article">
<meta property="og:title" content="mujoco快速上手">
<meta property="og:url" content="https://momaoto.github.io/posts/1644944583/index.html">
<meta property="og:site_name" content="momaoto&#39;s blog">
<meta property="og:description" content="mujoco学习笔记与问题记录。官方jupyter入门教程：https:&#x2F;&#x2F;github.com&#x2F;google-deepmind&#x2F;mujoco&#x2F;blob&#x2F;main&#x2F;python&#x2F;tutorial.ipynb   仿真器 123456# 安装mujocopip install mujocopip install mujoco-python-viewer# 启动可视化界面，可以直接把模型拖进去预览p">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-01-17T11:22:00.000Z">
<meta property="article:modified_time" content="2025-02-22T14:29:43.493Z">
<meta property="article:author" content="Momaoto">
<meta property="article:tag" content="笔记">
<meta property="article:tag" content="教程">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://momaoto.github.io/posts/1644944583/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://momaoto.github.io/posts/1644944583/","path":"posts/1644944583/","title":"mujoco快速上手"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>mujoco快速上手 | momaoto's blog</title>
  







<link rel="stylesheet" href="/css/callout_blocks.css">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">momaoto's blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-list fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-inbox fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%BF%E7%9C%9F%E5%99%A8"><span class="nav-number">1.</span> <span class="nav-text"> 仿真器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#tutorial"><span class="nav-number">1.1.</span> <span class="nav-text"> Tutorial</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mjmodel"><span class="nav-number">1.1.1.</span> <span class="nav-text"> mjModel</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mjdata"><span class="nav-number">1.1.2.</span> <span class="nav-text"> mjData</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rendering"><span class="nav-number">1.1.3.</span> <span class="nav-text"> rendering</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#simulation"><span class="nav-number">1.1.4.</span> <span class="nav-text"> Simulation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#degrees-of-freedom"><span class="nav-number">1.1.5.</span> <span class="nav-text"> Degrees of Freedom</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tendons"><span class="nav-number">1.1.6.</span> <span class="nav-text"> Tendons</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.</span> <span class="nav-text"> 模型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95"><span class="nav-number">3.</span> <span class="nav-text"> 问题记录</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83bug"><span class="nav-number">4.</span> <span class="nav-text"> 环境bug</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-a-module-that-was-compiled-using-numpy-1x-cannot-be-run-in-numpy-222-as-it-may-crash-to-support-both-1x-and-2x-versions-of-numpy-modules-must-be-compiled-with-numpy-20-some-module-may-need-to-rebuild-instead-eg-with-pybind11212"><span class="nav-number">4.1.</span> <span class="nav-text"> 1. A module that was compiled using NumPy 1.x cannot be run in NumPy 2.2.2 as it may crash. To support both 1.x and 2.x versions of NumPy, modules must be compiled with NumPy 2.0. Some module may need to rebuild instead e.g. with ‘pybind11&gt;&#x3D;2.12’.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-python-buildsflorianrhiempyglfwglfw-34srcwindowc711-glfwgetframebuffersize-assertion-window-null-failed"><span class="nav-number">4.2.</span> <span class="nav-text"> 2. python: &#x2F;builds&#x2F;florianrhiem&#x2F;pyGLFW&#x2F;glfw-3.4&#x2F;src&#x2F;window.c:711: glfwGetFramebufferSize: Assertion &#96;window !&#x3D; NULL’ failed.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-mujoco%E6%8A%A5%E9%94%99valueerror-xml-error-schema-violation-unrecognized-attribute-kv"><span class="nav-number">4.3.</span> <span class="nav-text"> 3. mujoco报错：ValueError: XML Error: Schema violation: unrecognized attribute: ‘kv’</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-libgl-error-mesa-loader-failed-to-open-iris"><span class="nav-number">4.4.</span> <span class="nav-text"> 4. libGL error: MESA-LOADER: failed to open iris</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E8%AE%AD%E7%BB%83%E6%97%B6%E5%87%BA%E7%8E%B0too-many-open-files"><span class="nav-number">4.5.</span> <span class="nav-text"> 5. 多线程训练时出现too many open files</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-runtimeerror-numpy-is-not-availablemodulenotfounderror-no-module-named-numpy_core"><span class="nav-number">4.6.</span> <span class="nav-text"> 6. RuntimeError: Numpy is not available；ModuleNotFoundError: No module named ‘numpy._core‘</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Momaoto"
      src="/avatar.jpg">
  <p class="site-author-name" itemprop="name">Momaoto</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="/hekun.tian@qq.com" title="E-Mail → hekun.tian@qq.com" rel="noopener me"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://momaoto.github.io/posts/1644944583/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpg">
      <meta itemprop="name" content="Momaoto">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="momaoto's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="mujoco快速上手 | momaoto's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          mujoco快速上手
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-01-17 19:22:00" itemprop="dateCreated datePublished" datetime="2025-01-17T19:22:00+08:00">2025-01-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-02-22 22:29:43" itemprop="dateModified" datetime="2025-02-22T22:29:43+08:00">2025-02-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">教程</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><blockquote>
<p>mujoco学习笔记与问题记录。官方jupyter入门教程：<a target="_blank" rel="noopener" href="https://github.com/google-deepmind/mujoco/blob/main/python/tutorial.ipynb">https://github.com/google-deepmind/mujoco/blob/main/python/tutorial.ipynb</a></p>
</blockquote>
<h1 id="仿真器"><a class="markdownIt-Anchor" href="#仿真器"></a> 仿真器</h1>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装mujoco</span></span><br><span class="line">pip install mujoco</span><br><span class="line">pip install mujoco-python-viewer</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动可视化界面，可以直接把模型拖进去预览</span></span><br><span class="line">python -m mujoco.viewer</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h2 id="tutorial"><a class="markdownIt-Anchor" href="#tutorial"></a> Tutorial</h2>
<h3 id="mjmodel"><a class="markdownIt-Anchor" href="#mjmodel"></a> mjModel</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原始模型xml文件</span></span><br><span class="line">xml = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;mujoco&gt;</span></span><br><span class="line"><span class="string">  &lt;worldbody&gt;</span></span><br><span class="line"><span class="string">    &lt;light name=&quot;top&quot; pos=&quot;0 0 1&quot;/&gt;</span></span><br><span class="line"><span class="string">    &lt;geom name=&quot;red_box&quot; type=&quot;box&quot; size=&quot;.2 .2 .2&quot; rgba=&quot;1 0 0 1&quot;/&gt;</span></span><br><span class="line"><span class="string">    &lt;geom name=&quot;green_sphere&quot; pos=&quot;.2 .2 .2&quot; size=&quot;.1&quot; rgba=&quot;0 1 0 1&quot;/&gt;</span></span><br><span class="line"><span class="string">  &lt;/worldbody&gt;</span></span><br><span class="line"><span class="string">&lt;/mujoco&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从xml生成model模型</span></span><br><span class="line">model = mujoco.MjModel.from_xml_string(xml)</span><br><span class="line"></span><br><span class="line">model.ngeom <span class="comment"># model里有几个geom</span></span><br><span class="line">model.geom_rgba <span class="comment"># 每个geom的颜色</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 快捷知道有哪些可用的geom</span></span><br><span class="line">model.geom()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接叫geom不指定属性会打印所有属性</span></span><br><span class="line">model.geom(<span class="string">&#x27;green_sphere&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印rgba</span></span><br><span class="line">model.geom(<span class="string">&#x27;green_sphere&#x27;</span>).rgba</span><br><span class="line"></span><br><span class="line"><span class="comment"># name与id相互转换</span></span><br><span class="line"><span class="built_in">id</span> = mujoco.mj_name2id(model, mujoco.mjtObj.mjOBJ_GEOM, <span class="string">&#x27;green_sphere&#x27;</span>)</span><br><span class="line">model.geom(<span class="string">&#x27;green_sphere&#x27;</span>).<span class="built_in">id</span></span><br><span class="line">model.geom(<span class="number">1</span>).name</span><br><span class="line">model.body(<span class="number">0</span>).name <span class="comment"># id为0的一定是world且不可改名</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印model中所有geom的name</span></span><br><span class="line">[model.geom(i).name <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(model.ngeom)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有物理选项（如重力、时间步等）</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 也可以直接在XML中&lt;mujoco&gt;的子标签中更改：</span></span><br><span class="line"><span class="string">&lt;mujoco&gt;</span></span><br><span class="line"><span class="string">	&lt;option gravity=&quot;0 0 10&quot;/&gt;</span></span><br><span class="line"><span class="string">&lt;/mujoco&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">model.opt </span><br></pre></td></tr></table></figure>
<h3 id="mjdata"><a class="markdownIt-Anchor" href="#mjdata"></a> mjData</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用model创建data</span></span><br><span class="line">data = mujoco.MjData(model)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印所有geom的(x,y,z)位置</span></span><br><span class="line"><span class="built_in">print</span>(data.geom_xpos)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印某一个geom的(x,y,z)位置</span></span><br><span class="line"><span class="built_in">print</span>(data.geom(<span class="string">&#x27;green_sphere&#x27;</span>).xpos)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算全局笛卡尔姿态, 必须要做几何对齐</span></span><br><span class="line">mujoco.mj_kinematics(model, data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;raw access:\n&#x27;</span>, data.geom_xpos)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="rendering"><a class="markdownIt-Anchor" href="#rendering"></a> rendering</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开启可视化渲染</span></span><br><span class="line"><span class="keyword">with</span> mujoco.Renderer(model) <span class="keyword">as</span> renderer:</span><br><span class="line">  mujoco.mj_forward(model, data) <span class="comment"># 渲染也要计算后使用</span></span><br><span class="line">  renderer.update_scene(data)</span><br><span class="line">  media.show_image(renderer.render())</span><br></pre></td></tr></table></figure>
<h3 id="simulation"><a class="markdownIt-Anchor" href="#simulation"></a> Simulation</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># enable joint visualization option:</span></span><br><span class="line">scene_option = mujoco.MjvOption()</span><br><span class="line">scene_option.flags[mujoco.mjtVisFlag.mjVIS_JOINT] = <span class="literal">True</span> <span class="comment"># 开关节显示</span></span><br><span class="line"></span><br><span class="line">duration = <span class="number">3.8</span>  <span class="comment"># (seconds)</span></span><br><span class="line">framerate = <span class="number">60</span>  <span class="comment"># (Hz)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Simulate and display video.</span></span><br><span class="line">frames = []</span><br><span class="line">mujoco.mj_resetData(model, data)</span><br><span class="line"><span class="keyword">with</span> mujoco.Renderer(model) <span class="keyword">as</span> renderer:</span><br><span class="line">  <span class="keyword">while</span> data.time &lt; duration:</span><br><span class="line">    mujoco.mj_step(model, data)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(frames) &lt; data.time * framerate:</span><br><span class="line">      renderer.update_scene(data, scene_option=scene_option)</span><br><span class="line">      pixels = renderer.render()</span><br><span class="line">      frames.append(pixels)</span><br><span class="line">      </span><br><span class="line">media.show_video(frames, fps=framerate)</span><br></pre></td></tr></table></figure>
<h3 id="degrees-of-freedom"><a class="markdownIt-Anchor" href="#degrees-of-freedom"></a> Degrees of Freedom</h3>
<p>Dof，即自由度，注意在mujoco中旋转使用四元数表示，有四个自由度（见问题记录）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Total number of DoFs in the model:&#x27;</span>, model.nv)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Generalized positions:&#x27;</span>, data.qpos) <span class="comment"># 所有geom的qpos写在一起</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Generalized velocities:&#x27;</span>, data.qvel) <span class="comment"># 旋转</span></span><br></pre></td></tr></table></figure>
<h3 id="tendons"><a class="markdownIt-Anchor" href="#tendons"></a> Tendons</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  &lt;tendon&gt;</span><br><span class="line">    &lt;spatial name=<span class="string">&quot;wire&quot;</span> limited=<span class="string">&quot;true&quot;</span> <span class="built_in">range</span>=<span class="string">&quot;0 0.35&quot;</span> width=<span class="string">&quot;0.003&quot;</span>&gt;</span><br><span class="line">      &lt;site site=<span class="string">&quot;anchor&quot;</span>/&gt;</span><br><span class="line">      &lt;site site=<span class="string">&quot;hook&quot;</span>/&gt;</span><br><span class="line">    &lt;/spatial&gt;</span><br><span class="line">  &lt;/tendon&gt;</span><br></pre></td></tr></table></figure>
<h1 id="模型"><a class="markdownIt-Anchor" href="#模型"></a> 模型</h1>
<p>用户以名为 MJCF 的 XML 文件格式定义 MuJoCo 模型。然后，内置编译器将该模型编译为低级数据结构 mjModel，该结构为运行时计算进行了交叉索引和优化。编译后的模型也可以保存在二进制 MJB 文件中。<br />
所谓MJCF，是对XML文件内容的一种约定，即以<code>&lt;mujoco&gt;</code>为唯一顶层元素的XML文件会被识别为mujoco模型文件。</p>
<p>示例：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mujoco</span>&gt;</span>  <span class="comment">&lt;!-- 唯一的顶级元素，将 XML 文件标识为 MJCF模型文件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">worldbody</span>&gt;</span>  <span class="comment">&lt;!-- 有且只有一个世界 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">light</span> <span class="attr">diffuse</span>=<span class="string">&quot;.5 .5 .5&quot;</span> <span class="attr">pos</span>=<span class="string">&quot;0 0 3&quot;</span> <span class="attr">dir</span>=<span class="string">&quot;0 0 -1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">geom</span> <span class="attr">type</span>=<span class="string">&quot;plane&quot;</span> <span class="attr">size</span>=<span class="string">&quot;1 1 0.1&quot;</span> <span class="attr">rgba</span>=<span class="string">&quot;.9 0 0 1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span> <span class="attr">pos</span>=<span class="string">&quot;0 0 1&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">joint</span> <span class="attr">type</span>=<span class="string">&quot;free&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">geom</span> <span class="attr">type</span>=<span class="string">&quot;box&quot;</span> <span class="attr">size</span>=<span class="string">&quot;.1 .2 .3&quot;</span> <span class="attr">rgba</span>=<span class="string">&quot;0 .9 0 1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">worldbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mujoco</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>worldbody顶层体，唯一，不能有子元素inertial和joint，它的name默认为&quot;world&quot;。</p>
</li>
<li>
<p>body其他体，可以有属性joint。</p>
</li>
<li>
<p>joint关节，是body的属性，定义其所属body与所属body的父体之间的自由度。类型有四种free, ball, slide, hinge，如下：</p>
<ul>
<li>free：自由，有6个自由度，分别是3个平移以及3个旋转。<strong>只能用于worldbody的子body</strong>。</li>
<li>ball：球体，只有3个旋转自由度，使用四元数表示状态（w,x,y,z），初始状态为(1,0,0,0)**。如果一个body有一个球状关节，它就不能有其他的旋转关节（球或铰链）。在同一个body中，允许将球状关节和滑动关节结合起来。</li>
<li>slide：滑动，只有1个平移自由度，使用一个位置（用于渲染）和一个方向（用于模拟）来描述。</li>
<li>hinge：铰链，只有1个旋转自由度，使用一个轴线与一个通过位置来描述，<strong>为默认类型</strong>。</li>
</ul>
</li>
<li>
<p>geom几何体，是body的属性，决定body的渲染外观与碰撞体积（以及可选的惯性属性）。类型有以下几种：</p>
<ul>
<li>plane：平面</li>
</ul>
</li>
</ul>
<h1 id="问题记录"><a class="markdownIt-Anchor" href="#问题记录"></a> 问题记录</h1>
<ol>
<li>keyframe对应的每种joint的qpos维数是多少？<br />
mujoco是面向过程设计的，因此大量的数据格式被设为向量，需要使用者自己知道向量中每一维度的含义。<br />
对应于上述关节类型，旋转的三自由度使用四元数（w,x,y,z）表示，平移的三自由度使用（x,y,z）表示。<strong>因此一个浮动基机器人本体的自由度是6，qpos维数是7</strong>。同理，四种关节对应的qpos维数如下：</li>
</ol>
<table>
<thead>
<tr>
<th><strong>关节类型</strong></th>
<th><strong>自由度</strong></th>
<th><strong><code>qpos</code> 维数</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>自由关节</strong></td>
<td>6</td>
<td>7</td>
<td>3平移 + 4旋转四元数</td>
</tr>
<tr>
<td><strong>滑动关节</strong></td>
<td>1</td>
<td>1</td>
<td>1平移</td>
</tr>
<tr>
<td><strong>铰链关节</strong></td>
<td>1</td>
<td>1</td>
<td>1旋转角度</td>
</tr>
<tr>
<td><strong>球形关节</strong></td>
<td>3</td>
<td>4</td>
<td>4旋转四元数</td>
</tr>
</tbody>
</table>
<h1 id="环境bug"><a class="markdownIt-Anchor" href="#环境bug"></a> 环境bug</h1>
<h2 id="1-a-module-that-was-compiled-using-numpy-1x-cannot-be-run-in-numpy-222-as-it-may-crash-to-support-both-1x-and-2x-versions-of-numpy-modules-must-be-compiled-with-numpy-20-some-module-may-need-to-rebuild-instead-eg-with-pybind11212"><a class="markdownIt-Anchor" href="#1-a-module-that-was-compiled-using-numpy-1x-cannot-be-run-in-numpy-222-as-it-may-crash-to-support-both-1x-and-2x-versions-of-numpy-modules-must-be-compiled-with-numpy-20-some-module-may-need-to-rebuild-instead-eg-with-pybind11212"></a> 1. A module that was compiled using NumPy 1.x cannot be run in NumPy 2.2.2 as it may crash. To support both 1.x and 2.x versions of NumPy, modules must be compiled with NumPy 2.0. Some module may need to rebuild instead e.g. with ‘pybind11&gt;=2.12’.</h2>
<p>报错中给了提示：If you are a user of the module, the easiest solution will be to<br />
downgrade to ‘numpy&lt;2’ or try to upgrade the affected module.<br />
We expect that some modules will need time to support NumPy 2.</p>
<p>所以：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install numpy==1.22.4</span><br></pre></td></tr></table></figure>
<h2 id="2-python-buildsflorianrhiempyglfwglfw-34srcwindowc711-glfwgetframebuffersize-assertion-window-null-failed"><a class="markdownIt-Anchor" href="#2-python-buildsflorianrhiempyglfwglfw-34srcwindowc711-glfwgetframebuffersize-assertion-window-null-failed"></a> 2. python: /builds/florianrhiem/pyGLFW/glfw-3.4/src/window.c:711: glfwGetFramebufferSize: Assertion `window != NULL’ failed.</h2>
<p>参考：<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/71010343/cannot-load-swrast-and-iris-drivers-in-fedora-35/72200748#72200748">stackoverflow</a></p>
<h2 id="3-mujoco报错valueerror-xml-error-schema-violation-unrecognized-attribute-kv"><a class="markdownIt-Anchor" href="#3-mujoco报错valueerror-xml-error-schema-violation-unrecognized-attribute-kv"></a> 3. mujoco报错：ValueError: XML Error: Schema violation: unrecognized attribute: ‘kv’</h2>
<p>mujoco 2.3.0报错：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ValueError: XML Error: Schema violation: unrecognized attribute: &#x27;kv&#x27;</span><br></pre></td></tr></table></figure>
<p>升级到最新版（3.2.7），又报错：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AttributeError: &#x27;mujoco._structs.MjData&#x27; object has no attribute &#x27;solver_iter&#x27;.</span><br></pre></td></tr></table></figure>
<p>这俩问题无法兼容解决。<br />
最终在3.2.7版下修改mujoco_rendering.py，将593行代码中的 self.data.solver_iter 更改为 self.data.solver_niter，解决。</p>
<h2 id="4-libgl-error-mesa-loader-failed-to-open-iris"><a class="markdownIt-Anchor" href="#4-libgl-error-mesa-loader-failed-to-open-iris"></a> 4. libGL error: MESA-LOADER: failed to open iris</h2>
<p>参考：<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/72110384/libgl-error-mesa-loader-failed-to-open-iris">stackoverflow</a><br />
<code>conda install -c conda-forge libstdcxx-ng</code></p>
<h2 id="5-多线程训练时出现too-many-open-files"><a class="markdownIt-Anchor" href="#5-多线程训练时出现too-many-open-files"></a> 5. 多线程训练时出现too many open files</h2>
<p>从字面意思上看就是说程序打开的文件数过多，不过这里的files不单是文件的意思，也包括打开的通讯链接(<strong>比如socket</strong>)，正在监听的端口等等，所以有时候也可以叫做<strong>句柄</strong>(handle)，这个错误通常也可以叫做句柄数超出系统限制。<br />
查看允许打开文件数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ulimit</span> -n</span><br></pre></td></tr></table></figure>
<p>修改它：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ulimit</span> -n 2048</span><br></pre></td></tr></table></figure>
<p>成功解决。</p>
<h2 id="6-runtimeerror-numpy-is-not-availablemodulenotfounderror-no-module-named-numpy_core"><a class="markdownIt-Anchor" href="#6-runtimeerror-numpy-is-not-availablemodulenotfounderror-no-module-named-numpy_core"></a> 6. RuntimeError: Numpy is not available；ModuleNotFoundError: No module named ‘numpy._core‘</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_45276337/article/details/143689539">https://blog.csdn.net/m0_45276337/article/details/143689539</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag"># 笔记</a>
              <a href="/tags/%E6%95%99%E7%A8%8B/" rel="tag"># 教程</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/3168300427/" rel="prev" title="配置CUDA-Pytorch全家桶问题记录">
                  <i class="fa fa-angle-left"></i> 配置CUDA-Pytorch全家桶问题记录
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/3274646838/" rel="next" title="Linux系统设置vnc开机自启">
                  Linux系统设置vnc开机自启 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa-solid fa-palette"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Momaoto</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">89k</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user-group"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div><script color="190,190,190" opacity="0.8" zIndex="-1" count="100" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>


    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin="anonymous">



</body>
</html>
